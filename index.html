<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ular Tangga Sosiologi: Perubahan Sosial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f0f9ff;
        }

        .board-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 4px;
            width: 100%;
            max-width: 900px;
            aspect-ratio: 2/1;
            margin: 0 auto;
        }

        .tile {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }
        
        .tile:nth-child(even) { background-color: #ffffff; }
        .tile:nth-child(odd) { background-color: #e0f2fe; }

        /* Ular (Turun) */
        .snake {
            background-color: #fee2e2 !important;
            border: 2px solid #ef4444;
        }
        
        /* Tangga (Naik) */
        .ladder {
            background-color: #dcfce7 !important;
            border: 2px solid #22c55e;
        }

        .player-token {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            position: absolute;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 10;
        }

        /* Player Colors */
        .p1 { background-color: #ef4444; bottom: 5px; left: 5px; } /* Red */
        .p2 { background-color: #3b82f6; bottom: 5px; right: 5px; } /* Blue */
        .p3 { background-color: #eab308; top: 5px; left: 5px; } /* Yellow */
        .p4 { background-color: #22c55e; top: 5px; right: 5px; } /* Green */

        .modal {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
        }

        .dice-shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col items-center justify-center p-4">

    <!-- Setup Screen -->
    <div id="setupScreen" class="w-full max-w-md bg-white p-8 rounded-2xl shadow-xl text-center">
        <h1 class="text-3xl font-bold text-indigo-600 mb-2">Sosiologi Seru!</h1>
        <p class="text-gray-600 mb-6">Materi: Perubahan Sosial (Kelas XII/X)</p>
        
        <div class="mb-6">
            <label class="block text-gray-700 font-semibold mb-2">Jumlah Tim / Pemain:</label>
            <div class="flex justify-center gap-4">
                <button onclick="setPlayers(2)" class="px-6 py-3 bg-indigo-100 hover:bg-indigo-600 hover:text-white rounded-lg transition font-bold text-xl">2</button>
                <button onclick="setPlayers(3)" class="px-6 py-3 bg-indigo-100 hover:bg-indigo-600 hover:text-white rounded-lg transition font-bold text-xl">3</button>
                <button onclick="setPlayers(4)" class="px-6 py-3 bg-indigo-100 hover:bg-indigo-600 hover:text-white rounded-lg transition font-bold text-xl">4</button>
            </div>
        </div>
        <p class="text-xs text-gray-400">Martini Sugatri SMAN 1 Bantul</p>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="hidden w-full max-w-5xl flex flex-col md:flex-row gap-6">
        
        <!-- Board Area -->
        <div class="flex-1 order-2 md:order-1">
            <div class="bg-white p-4 rounded-xl shadow-lg">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-gray-800">Arena Ular Tangga</h2>
                    <div class="flex gap-2 text-sm">
                        <span class="flex items-center"><div class="w-3 h-3 bg-green-500 mr-1 rounded"></div> Naik</span>
                        <span class="flex items-center"><div class="w-3 h-3 bg-red-500 mr-1 rounded"></div> Turun</span>
                    </div>
                </div>
                <div id="board" class="board-grid relative bg-white border-2 border-gray-200 rounded-lg overflow-hidden">
                    <!-- Tiles will be generated by JS -->
                </div>
            </div>
        </div>

        <!-- Controls Area -->
        <div class="w-full md:w-80 order-1 md:order-2 flex flex-col gap-4">
            
            <!-- Current Player Card -->
            <div class="bg-white p-6 rounded-xl shadow-lg text-center border-t-8 border-indigo-500" id="playerCard">
                <h3 class="text-gray-500 text-sm font-semibold uppercase tracking-wider">Giliran</h3>
                <div id="turnIndicator" class="text-2xl font-black text-indigo-600 my-2">TIM 1</div>
                <div class="text-4xl my-4" id="diceDisplay">üé≤</div>
                <button id="rollBtn" onclick="rollDice()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg shadow transition transform active:scale-95">
                    Kocok Dadu!
                </button>
            </div>

            <!-- Leaderboard -->
            <div class="bg-white p-4 rounded-xl shadow-lg flex-1">
                <h3 class="font-bold text-gray-700 mb-3 border-b pb-2">Klasemen Poin</h3>
                <div id="scoreBoard" class="space-y-3">
                    <!-- Scores generated by JS -->
                </div>
            </div>

            <!-- Log -->
            <div class="bg-gray-800 text-white p-3 rounded-xl text-xs h-32 overflow-y-auto font-mono" id="gameLog">
                <p>> Selamat datang di Sosiologi Games!</p>
            </div>
        </div>
    </div>

    <!-- Question Modal -->
    <div id="questionModal" class="hidden fixed inset-0 modal flex items-center justify-center z-50 px-4">
        <div class="bg-white w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden transform transition-all scale-100">
            <div class="bg-indigo-600 p-4 text-white flex justify-between items-center">
                <h3 class="font-bold text-lg"><i class="fas fa-question-circle mr-2"></i>Pertanyaan Sosiologi</h3>
                <span class="bg-indigo-800 px-2 py-1 rounded text-xs">Poin: +/- 10</span>
            </div>
            <div class="p-6">
                <p id="qText" class="text-gray-800 font-semibold text-lg mb-6">Pertanyaan akan muncul di sini...</p>
                <div id="qOptions" class="space-y-3">
                    <!-- Options generated by JS -->
                </div>
            </div>
            <div class="bg-gray-50 px-6 py-3 text-right">
                <span id="timer" class="text-red-500 font-bold text-sm"></span>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div id="alertModal" class="hidden fixed inset-0 modal flex items-center justify-center z-50">
        <div class="bg-white w-full max-w-sm rounded-xl p-6 text-center shadow-xl m-4">
            <div id="alertIcon" class="text-5xl mb-4">üéâ</div>
            <h3 id="alertTitle" class="text-xl font-bold mb-2">Judul</h3>
            <p id="alertMsg" class="text-gray-600 mb-6">Pesan</p>
            <button onclick="closeAlert()" class="bg-gray-800 text-white px-6 py-2 rounded-lg hover:bg-gray-900 transition">Lanjut</button>
        </div>
    </div>

    <script>
        // --- GAME CONFIGURATION ---
        const BOARD_SIZE = 50; // 5 rows of 10
        const ROWS = 5;
        const COLS = 10;
        
        // Snakes and Ladders Mapping (Start -> End)
        // Adjust these to ensure they don't create infinite loops
        const SNAKES = { 48: 12, 35: 20, 28: 10, 45: 25 }; 
        const LADDERS = { 3: 18, 9: 27, 21: 42, 15: 36 };

        // Question Bank (Perubahan Sosial)
        const QUESTIONS = [
            { q: "Perubahan sosial yang terjadi secara cepat dan mengubah dasar-dasar kehidupan masyarakat disebut...", options: ["Evolusi", "Revolusi", "Rotasi", "Akulturasi"], correct: 1 },
            { q: "Penemuan baru yang sudah diakui dan digunakan oleh masyarakat disebut...", options: ["Discovery", "Invention", "Inovasi", "Difusi"], correct: 1 },
            { q: "Sikap masyarakat yang cenderung menolak perubahan karena menganggap budaya lama lebih baik disebut...", options: ["Vested Interest", "Konservatif", "Progresif", "Apatis"], correct: 1 },
            { q: "Salah satu faktor eksternal penyebab perubahan sosial adalah...", options: ["Pemberontakan", "Konflik masyarakat", "Bencana alam", "Penemuan baru"], correct: 2 },
            { q: "Perubahan mode pakaian termasuk bentuk perubahan...", options: ["Besar", "Kecil", "Struktural", "Proses"], correct: 1 },
            { q: "Teori yang berpandangan bahwa perubahan sosial memiliki arah tetap dan bertahap dari primitif ke modern adalah...", options: ["Teori Siklus", "Teori Konflik", "Teori Evolusi", "Teori Fungsional"], correct: 2 },
            { q: "Proses penyebaran unsur budaya dari satu individu ke individu lain disebut...", options: ["Difusi", "Asimilasi", "Akulturasi", "Invasi"], correct: 0 },
            { q: "Berikut ini yang BUKAN merupakan agen perubahan (Agent of Change) adalah...", options: ["Guru", "Mahasiswa", "Pemerintah", "Orang gila"], correct: 3 },
            { q: "Modernisasi seringkali dikaitkan dengan...", options: ["Westernisasi", "Sekularisasi", "Kemajuan IPTEK", "Demoralisasi"], correct: 2 },
            { q: "Dampak negatif perubahan sosial yang ditandai dengan kemerosotan moral disebut...", options: ["Kriminalitas", "Dekadensi Moral", "Kesenjangan Sosial", "Konsumerisme"], correct: 1 },
            { q: "Teori Siklus beranggapan bahwa perubahan sosial itu ibarat...", options: ["Garis lurus", "Roda berputar", "Anak tangga", "Pohon bercabang"], correct: 1 },
            { q: "Perubahan yang tidak direncanakan biasanya menimbulkan...", options: ["Kesejahteraan", "Akibat yang tidak diharapkan", "Kemajuan", "Stabilitas"], correct: 1 },
            { q: "Globalisasi memudahkan masuknya budaya asing. Sikap yang tepat adalah...", options: ["Menolak semua", "Menerima semua", "Selektif", "Apatis"], correct: 2 },
            { q: "Ketertinggalan budaya (Cultural Lag) terjadi karena...", options: ["Budaya material berubah lebih cepat dari non-material", "Masyarakat menolak teknologi", "Bencana alam", "Perang"], correct: 0 },
            { q: "Ogburn menyatakan bahwa perubahan sosial mencakup unsur-unsur...", options: ["Biologis", "Kebudayaan baik material maupun immaterial", "Geografis", "Ekonomi saja"], correct: 1 }
        ];

        // --- STATE VARIABLES ---
        let players = []; 
        let currentPlayerIdx = 0;
        let isMoving = false;
        let tempDiceValue = 0;

        // --- INITIALIZATION ---
        function setPlayers(count) {
            const colors = ['bg-red-500', 'bg-blue-500', 'bg-yellow-400', 'bg-green-500'];
            const names = ['Tim Merah', 'Tim Biru', 'Tim Kuning', 'Tim Hijau'];
            
            players = [];
            for(let i=0; i<count; i++) {
                players.push({
                    id: i,
                    name: names[i],
                    colorClass: colors[i],
                    pos: 1, // Start at 1
                    score: 0
                });
            }

            document.getElementById('setupScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            renderBoard();
            updateUI();
            log("Permainan dimulai! Selamat bertanding.");
        }

        function renderBoard() {
            const board = document.getElementById('board');
            board.innerHTML = '';
            
            // Generate zig-zag grid logic
            // 5 rows, 10 cols.
            // Row 4 (bottom): 1-10 (L to R)
            // Row 3: 11-20 (R to L)
            // Row 2: 21-30 (L to R)
            // Row 1: 31-40 (R to L)
            // Row 0 (top): 41-50 (L to R)
            
            let tiles = [];
            for (let r = ROWS - 1; r >= 0; r--) {
                let rowTiles = [];
                for (let c = 0; c < COLS; c++) {
                    // Calculate number based on row parity
                    let num;
                    if ((ROWS - 1 - r) % 2 === 0) {
                         // Even row from bottom (0, 2, 4...) -> Left to Right
                         num = (ROWS - 1 - r) * COLS + c + 1;
                    } else {
                        // Odd row from bottom (1, 3...) -> Right to Left
                        num = (ROWS - 1 - r) * COLS + (COLS - 1 - c) + 1;
                    }
                    rowTiles.push(num);
                }
                if ((ROWS - 1 - r) % 2 !== 0) {
                     // If it was generated R to L logic, the visual grid simply fills L to R, 
                     // so we just need to ensure the numbers map correctly to the grid slots.
                     // Actually CSS Grid fills L-R, T-B. 
                     // So we need to push numbers into array in the order of Grid Slots (0 to 49).
                }
            }
            
            // Let's redo mapping simply by visual slot index (0-49)
            for (let i = 0; i < BOARD_SIZE; i++) {
                let row = Math.floor(i / COLS); // 0 is top row
                let col = i % COLS;
                
                // Calculate logic number
                let boardRowIndex = ROWS - 1 - row; // 0 is bottom row logic
                let tileNum;
                
                if (boardRowIndex % 2 === 0) {
                    // Left to Right
                    tileNum = (boardRowIndex * COLS) + col + 1;
                } else {
                    // Right to Left
                    tileNum = (boardRowIndex * COLS) + (COLS - 1 - col) + 1;
                }

                const div = document.createElement('div');
                div.className = 'tile text-gray-400';
                div.id = `tile-${tileNum}`;
                div.innerHTML = `<span class="absolute top-1 left-1 opacity-50 text-xs">${tileNum}</span>`;

                if (tileNum === 1) div.innerHTML += `<span class="text-xs font-bold text-green-600">START</span>`;
                if (tileNum === 50) div.innerHTML += `<span class="text-xs font-bold text-red-600">FINISH</span>`;
                
                // Add Snake/Ladder Markers
                if (SNAKES[tileNum]) {
                    div.classList.add('snake');
                    div.innerHTML += `<i class="fas fa-arrow-down text-red-600 text-lg opacity-80"></i><span class="text-xs text-red-700 absolute bottom-1">${SNAKES[tileNum]}</span>`;
                }
                if (LADDERS[tileNum]) {
                    div.classList.add('ladder');
                    div.innerHTML += `<i class="fas fa-arrow-up text-green-600 text-lg opacity-80"></i><span class="text-xs text-green-800 absolute bottom-1">${LADDERS[tileNum]}</span>`;
                }

                board.appendChild(div);
            }
            
            renderPlayers();
        }

        function renderPlayers() {
            // Remove old tokens
            document.querySelectorAll('.player-token').forEach(e => e.remove());

            players.forEach((p, idx) => {
                const tile = document.getElementById(`tile-${p.pos}`);
                if (tile) {
                    const token = document.createElement('div');
                    token.className = `player-token p${idx+1} ${p.colorClass}`;
                    token.title = p.name;
                    tile.appendChild(token);
                }
            });
        }

        function updateUI() {
            const p = players[currentPlayerIdx];
            const card = document.getElementById('playerCard');
            const turnText = document.getElementById('turnIndicator');
            
            // Update Card Color Border
            card.className = `bg-white p-6 rounded-xl shadow-lg text-center border-t-8 ${p.colorClass.replace('bg-', 'border-')}`;
            turnText.innerText = p.name;
            turnText.className = `text-2xl font-black my-2 ${p.colorClass.replace('bg-', 'text-')}`;

            // Update Scoreboard
            const sb = document.getElementById('scoreBoard');
            sb.innerHTML = '';
            players.forEach(pl => {
                sb.innerHTML += `
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded">
                    <div class="flex items-center">
                        <div class="w-3 h-3 rounded-full ${pl.colorClass} mr-2"></div>
                        <span class="font-semibold text-sm text-gray-700">${pl.name}</span>
                    </div>
                    <span class="font-bold text-indigo-600">${pl.score} Poin</span>
                </div>`;
            });
        }

        function log(msg) {
            const l = document.getElementById('gameLog');
            l.innerHTML = `<div>> ${msg}</div>` + l.innerHTML;
        }

        // --- GAME LOGIC ---

        function rollDice() {
            if (isMoving) return;
            isMoving = true;

            const diceDisplay = document.getElementById('diceDisplay');
            diceDisplay.classList.add('dice-shake');

            setTimeout(() => {
                diceDisplay.classList.remove('dice-shake');
                tempDiceValue = Math.floor(Math.random() * 6) + 1;
                diceDisplay.innerText = `üé≤ ${tempDiceValue}`;
                
                // Show Question First
                showQuestion();
            }, 600);
        }

        function showQuestion() {
            const modal = document.getElementById('questionModal');
            const qText = document.getElementById('qText');
            const qOptions = document.getElementById('qOptions');
            
            // Random unique question logic could be added here, currently just random
            const qIdx = Math.floor(Math.random() * QUESTIONS.length);
            const q = QUESTIONS[qIdx];

            qText.innerText = q.q;
            qOptions.innerHTML = '';

            q.options.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-indigo-50 hover:border-indigo-300 transition text-sm font-medium text-gray-700";
                btn.innerText = `${["A","B","C","D"][idx]}. ${opt}`;
                btn.onclick = () => answerQuestion(idx === q.correct);
                qOptions.appendChild(btn);
            });

            modal.classList.remove('hidden');
        }

        function answerQuestion(isCorrect) {
            document.getElementById('questionModal').classList.add('hidden');
            const player = players[currentPlayerIdx];

            if (isCorrect) {
                log(`${player.name} Benar! Maju ${tempDiceValue} langkah.`);
                player.score += 10;
                movePlayer(player.id, tempDiceValue);
            } else {
                // Wrong answer
                log(`${player.name} Salah! Mundur 1 langkah & poin -10.`);
                player.score = Math.max(0, player.score - 10);
                movePlayer(player.id, -1); // Move back 1
            }
        }

        function movePlayer(playerId, steps) {
            const p = players[playerId];
            let current = p.pos;
            let target = current + steps;

            // Boundary checks
            if (target < 1) target = 1;
            if (target > BOARD_SIZE) target = BOARD_SIZE - (target - BOARD_SIZE); // Bounce back effect? Or just cap. Let's cap for simplicity or bounce.
            // Let's just cap at 50 for now to trigger win easily
            if (target >= BOARD_SIZE) target = BOARD_SIZE;

            // Animate step by step visually? 
            // For simplicity in this code, we just update position, but let's do a small delay
            p.pos = target;
            renderPlayers();
            updateUI();

            // Check Win
            if (p.pos === BOARD_SIZE) {
                showAlert("üèÜ KEMENANGAN!", `Selamat! ${p.name} telah mencapai garis finish dengan skor ${p.score}!`);
                isMoving = false;
                return;
            }

            // Check Snake or Ladder (only if moving forward, usually)
            setTimeout(() => {
                if (SNAKES[p.pos]) {
                    log(`${p.name} terkena Ular! Turun ke ${SNAKES[p.pos]}`);
                    showAlert("üêç Awas Ular!", "Yah, kamu turun ke bawah!");
                    p.pos = SNAKES[p.pos];
                    renderPlayers();
                } else if (LADDERS[p.pos]) {
                    log(`${p.name} menemukan Tangga! Naik ke ${LADDERS[p.pos]}`);
                    showAlert("ü™ú Naik Tangga!", "Hore! Kamu naik ke atas!");
                    p.pos = LADDERS[p.pos];
                    renderPlayers();
                }

                endTurn();
            }, 800);
        }

        function endTurn() {
            currentPlayerIdx = (currentPlayerIdx + 1) % players.length;
            updateUI();
            isMoving = false;
        }

        // --- UTILS ---
        function showAlert(title, msg) {
            const m = document.getElementById('alertModal');
            document.getElementById('alertTitle').innerText = title;
            document.getElementById('alertMsg').innerText = msg;
            
            if(title.includes("Ular")) document.getElementById('alertIcon').innerText = "üêç";
            else if(title.includes("Tangga")) document.getElementById('alertIcon').innerText = "ü™ú";
            else document.getElementById('alertIcon').innerText = "üéâ";

            m.classList.remove('hidden');
        }

        function closeAlert() {
            document.getElementById('alertModal').classList.add('hidden');
        }

    </script>
</body>

</html>


